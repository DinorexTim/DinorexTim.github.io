## æ•´æ•°æ¦‚è®º

### æ•´é™¤æ€§

**æ•´é™¤**ï¼šè®¾$a,b,m$å‡ä¸ºæ•´æ•°ï¼Œè‹¥å­˜åœ¨æŸä¸ª$m$ä½¿å¾—$a=mb$æˆç«‹ï¼Œåˆ™ç§°éžé›¶æ•°bæ•´é™¤aã€‚bæ•´é™¤aé€šå¸¸ç”¨b|aè¡¨ç¤ºã€‚

**å› å­**ï¼šè‹¥$b|a$ï¼Œå¹¶ä¸”$a$ä¸ºæ­£æ•´æ•°ï¼Œæˆ‘ä»¬è¯´$b$æ˜¯$a$çš„ä¸€ä¸ªå› å­ã€‚

### æœ€å¤§å…¬å› å­

ä¸¤ä¸ªæ­£æ•´æ•°$a,b$çš„æœ€å¤§å…¬å› å­ï¼Œè®°ä¸º$c=gcdâ¡(a,b)$

$c$æ˜¯æ»¡è¶³$c|a$ä¸”$c|b$çš„æœ€å¤§æ•´æ•°ï¼Œå³$c$èƒ½æ•´é™¤$a$,ä¹Ÿèƒ½æ•´é™¤$b$ã€‚

å¯¹äºŽä»»ä½•æ­£æ•´æ•°$a$, $gcdâ¡(a,0)=a$

å¦‚æžœ$a,b$æ˜¯äº’ç´ çš„(relatively prime)ï¼Œåˆ™$gcdâ¡(a,b)=1$

### ç´ æ•°

- æ•´æ•°$p>1$æ˜¯ç´ æ•°ï¼Œå½“ä¸”ä»…å½“å®ƒåªæœ‰å› å­$1$å’Œ$p$ã€‚
- **åŸºæœ¬å®šç†**ï¼šä»»ä½•æ•´æ•°a>1éƒ½å¯ä»¥å”¯ä¸€åœ°å› å¼åˆ†è§£ä¸º

$$a=p_1^{e_1}\times p_2^{e_2}\times \cdots p_k^{e_k}$$

å…¶ä¸­$p_i$æ˜¯ç´ æ•°ï¼Œ$e_i$æ˜¯$p_i$åœ¨$a$ä¸­å‡ºçŽ°çš„æ¬¡æ•°ã€‚

### æ¨¡è¿ç®—

$aÂ \pmod{n}$å°†æ•´æ•°aæ˜ å°„åˆ°é›†åˆ$\{0,1,â‹¯,nâˆ’1\}$ï¼Œåœ¨è¿™ä¸ªé™åˆ¶é›†åˆä¸Šè¿›è¡Œçš„ç®—æœ¯è¿ç®—ï¼Œç§°ä¸º**æ¨¡è¿ç®—**

å®šä¹‰$Z_n$ä¸ºæ¯”$n$å°çš„éžè´Ÿæ•´æ•°ç»„æˆçš„é›†åˆï¼š

$$Z_n={0,1,â‹¯,(nâˆ’1)}$$

è¿™ä¸ªé›†åˆç§°ä¸º**å‰©ä½™ç±»é›†**ï¼Œæˆ–æ¨¡nçš„**å‰©ä½™ç±»**(residue classes modÂ n)ã€‚

## ç¦»æ•£å¯¹æ•°

### æœ¬åŽŸæ ¹

å¦‚æžœ$a$æ˜¯$n$çš„**æœ¬åŽŸæ ¹**ï¼Œåˆ™$a^1,a^2,â€¦,a^Ï†(n)$æ˜¯å„ä¸ç›¸åŒçš„ï¼Œä¸”å‡ä¸Ž$n$äº’ç´ ã€‚å³$a$æ¨¡$n$çš„æ•´æ•°å¹‚$a^1,a^2,â€¦,a^Ï†(n)$èƒ½äº§ç”Ÿæ¨¡$n$çš„éžé›¶æ•´æ•°é›†

### ç¦»æ•£å¯¹æ•°

å¯¹äºŽç´ æ•°$p$ï¼Œ$a$çš„1åˆ°(p-1)çš„å„æ¬¡å¹‚æ°å¥½å¯ä»¥äº§ç”Ÿ1åˆ°p-1çš„æ•´æ•°ï¼Œå¯¹ä»»ä½•ä¸€ä¸ªæ•´æ•°bï¼Œæœ‰å”¯ä¸€çš„å¹‚iä½¿å¾—

$$b\equiv a^i\pmod{p}\quad (1\leq i\leq p-1)$$

è¯¥æŒ‡æ•°iç§°ä¸º$a$åœ¨æ¨¡$p$ä¸‹çš„**ç¦»æ•£å¯¹æ•°**ï¼Œè®°ä½œ$dlog_{a,p}(b)$ã€‚

### ç¦»æ•£å¯¹æ•°é—®é¢˜(DLP)

ç»™å®š$bâˆˆZ_p^âˆ—$, æœ¬åŽŸæ ¹a, ç´ æ•°p, è®¡ç®—iä½¿å¾—$bâ‰¡a^iÂ (modÂ p)$æ˜¯éžå¸¸å›°éš¾çš„(å°¤å…¶på¾ˆå¤§æ—¶)ã€‚

$a^iâ‰¡b(modÂ p)$æ˜¯ä¸€ä¸ª**å•å‘å‡½æ•°**(one-way function)


## ç»å…¸ç®—æ³•

### æ¬§å‡ é‡Œå¾—ç®—æ³•

è®¾ð‘Ž,ð‘æ˜¯ä»»æ„ä¸¤ä¸ªæ­£æ•´æ•°ï¼Œåˆ™æœ‰$gcd(a,b)=gcd(b,a \pmod{b})$

### æ‰©å±•æ¬§å‡ é‡Œå¾—ç®—æ³•

åœ¨å…¬é’¥å¯†é’¥å­¦ä¸­æœ‰ç€é‡è¦åº”ç”¨ï¼Œå¯ä»¥ç”¨äºŽè®¡ç®—ä¹˜æ³•é€†

ä¸ä»…å¯ä»¥å¯ä»¥è®¡ç®—å‡ºæœ€å¤§å…¬å› å­dï¼Œè€Œä¸”å¯ä»¥è®¡ç®—å‡ºä¸¤ä¸ªæ•´æ•°$x,y$ï¼Œä½¿å¾—$ax+by=d=gcd(a,b)$

> xå’Œyä¸€å®šå…·æœ‰ç›¸åçš„æ­£è´Ÿå·

### ç´ æ€§æ£€æµ‹ï¼ˆMiller-Rabinç®—æ³•ï¼‰

TEST(n)ç®—æ³•æµç¨‹ï¼š

1. è¾“å…¥æ•´æ•°$k,q$ï¼Œå…¶ä¸­$k>0$ï¼Œqä¸ºå¥‡æ•°ï¼Œä½¿å¾—$(n-1=2^kq)$
2. é€‰æ‹©$a$ï¼Œ$1\leq a\leq n-1$
3. è®¡ç®—$a^q\pmod{n}$
4. å¦‚æžœ$a^q\pmod{n}=1$ï¼Œåˆ™è¾“å‡ºâ€œnå¯èƒ½æ˜¯ç´ æ•°â€
5. å¦åˆ™For j=0,1,2,â€¦,k-1ï¼Œå¦‚æžœ$a^((2^j)*q)\pmod{n}=n-1$ï¼Œåˆ™è¾“å‡ºâ€œnå¯èƒ½æ˜¯ç´ æ•°â€
6. è¿”å›žåˆæ•°

MRç®—æ³•çš„**æ¦‚çŽ‡æ€§**ï¼šå¦‚æžœné€šè¿‡ç´ æ€§æ£€æµ‹ï¼Œn**ä¹Ÿæœ‰å¯èƒ½ä¸æ˜¯ç´ æ•°**

## å…³é”®å®šç†

### è´¹é©¬å°å®šç†

å¦‚æžœ$p$æ˜¯ç´ æ•°ï¼Œ$a$æ˜¯æ­£æ•´æ•°å¹¶ä¸”ä¸èƒ½è¢«$p$æ•´é™¤ï¼Œåˆ™

$$a^{p-1}\equiv 1\pmod{p}$$

å¦ä¸€ç§è¡¨ç¤ºå½¢å¼ä¸º

$$a^p\equiv a\pmod{p}$$

> è¯¥å½¢å¼ä¸è¦æ±‚aå’Œpäº’ç´ 

### æ¬§æ‹‰å®šç†

è‹¥$a$ä¸Ž$n$äº’ç´ ï¼Œåˆ™

$$a^{\varphi(n)}\equiv 1\pmod{n}$$

### ä¸­å›½å‰©ä½™å®šç†

ã€Šå­™å­ç®—ç»ã€‹çš„â€œç‰©ä¸çŸ¥æ•°â€é—®é¢˜ï¼šä»Šæœ‰ç‰©ä¸çŸ¥å…¶æ•°ï¼Œä¸‰ä¸‰æ•°ä¹‹å‰©äºŒï¼Œäº”äº”æ•°ä¹‹å‰©ä¸‰ï¼Œä¸ƒä¸ƒæ•°ä¹‹å‰©äºŒï¼Œé—®ç‰©å‡ ä½•ï¼Ÿ

è¯¥é—®é¢˜ç”¨æ–¹ç¨‹ç»„è¡¨ç¤ºä¸ºï¼š

$$\begin{cases}
    A\equiv 2\pmod{3}\\
    A\equiv 3\pmod{5}\\
    A\equiv 2\pmod{7}
\end{cases}$$

ä¸­å›½å‰©ä½™å®šç†(CRT)ï¼šè®¾$m_1,\dots m_k$æ˜¯ä¸¤ä¸¤äº’ç´ çš„æ­£æ•´æ•°ï¼Œ$M=\prod_{i=1}^k m_i$ï¼Œæ±‚ä¸€æ¬¡åŒä½™æ–¹ç¨‹ç»„

$$\begin{cases}
    a_1\pmod{m_1}\equiv A\\
    a_2\pmod{m_2}\equiv A\\
    \dots\\
    a_k\pmod{m_k}\equiv A
\end{cases}$$

å¯¹æ¨¡Mæœ‰å”¯ä¸€è§£ï¼Œä»¤$M_i=M/m_i$ï¼Œåˆ™

$$A=\sum_{i=1}^k M_ie_ia_i\pmod{M} \equiv(M_1e_1a_1+M_2e_2a_2+\dots+M_ke_ka_k)\pmod{M}$$

> å…¶ä¸­$e_i$æ»¡è¶³$M_ie_i\equiv 1\pmod{m_i}$